<ion-content class="ion-padding">

  @if (receivedRequests.isLoading()) {
    <ion-spinner></ion-spinner>
  } @else if (receivedRequests.error()) {
    <ion-text color="danger"><p>Error al cargar solicitudes.</p></ion-text>
  } @else {

    <!-- Pendientes -->
    <ion-card>
      <ion-card-header><ion-card-title>Pendientes</ion-card-title></ion-card-header>
      <ion-card-content>
        @if (pendingReceived().length) {
          @for (req of pendingReceived(); track req.id) {
            <ion-item lines="full">
              <ion-label>
                <h3>#{{ req.id }} - {{ req.creation_date | date:'dd-MM-yyyy' }}</h3>
              </ion-label>
              <ion-buttons slot="end">
                <ion-button color="success" 
                  (click)="responderSolicitud(req.id, 'accepted')"
                >Aceptar
                </ion-button>
                <ion-button 
                  color="danger" 
                  (click)="responderSolicitud(req.id, 'rejected')"
                >Rechazar
              </ion-button>
              </ion-buttons>
            </ion-item>
          }
        } @else { <ion-text 
            color="medium"><p>No hay solicitudes pendientes.</p></ion-text> }
      </ion-card-content>
    </ion-card>

    <!-- Todas -->
    <ion-card>
      <ion-card-header><ion-card-title>Todas</ion-card-title></ion-card-header>
      <ion-card-content>
        @if (allReceived().length) {
          @for (req of allReceived(); track req.id) {
            <ion-item lines="full">
              <ion-label>
                <h3>#{{ req.id }} - {{ req.state }}</h3>
                <p>{{ req.creation_date | date:'dd-MM-yyyy' }}</p>
                <p>Libros solicitados:</p>
              </ion-label>
            </ion-item>
          }
        } @else { <ion-text color="medium"><p>No tienes solicitudes.</p></ion-text> }
      </ion-card-content>
    </ion-card>

  }
</ion-content>
